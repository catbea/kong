module.exports=function(){"function"!=typeof Array.prototype.forEach&&(Array.prototype.forEach=function(e){for(var n=0;n<this.length;n++)e.apply(this,[this[n],n,this])});var e={},n={login:function(e,n,t){},syncMsgs:function(e,n){},getC2CHistoryMsgs:function(e,n,t){},syncGroupMsgs:function(e,n,t){},sendMsg:function(e,n,t){},logout:function(e,n){},setAutoRead:function(e,n,t){},getProfilePortrait:function(e,n,t){},setProfilePortrait:function(e,n,t){},applyAddFriend:function(e,n,t){},getPendency:function(e,n,t){},deletePendency:function(e,n,t){},responseFriend:function(e,n,t){},getAllFriend:function(e,n,t){},deleteFriend:function(e,n,t){},addBlackList:function(e,n,t){},getBlackList:function(e,n,t){},deleteBlackList:function(e,n,t){},uploadPic:function(e,n,t){},createGroup:function(e,n,t){},applyJoinGroup:function(e,n,t){},handleApplyJoinGroup:function(e,n,t){},deleteApplyJoinGroupPendency:function(e,n,t){},quitGroup:function(e,n,t){},getGroupPublicInfo:function(e,n,t){},getGroupInfo:function(e,n,t){},modifyGroupBaseInfo:function(e,n,t){},destroyGroup:function(e,n,t){},getJoinedGroupListHigh:function(e,n,t){},getGroupMemberInfo:function(e,n,t){},addGroupMember:function(e,n,t){},modifyGroupMember:function(e,n,t){},forbidSendMsg:function(e,n,t){},deleteGroupMember:function(e,n,t){},getPendencyGroup:function(e,n,t){},getPendencyReport:function(e,n,t){},getPendencyGroupRead:function(e,n,t){},sendCustomGroupNotify:function(e,n,t){},Msg:function(e,n,t,o,r,i,s,u,a){},MsgStore:{sessMap:function(){return{}},sessCount:function(){return 0},sessByTypeId:function(e,n){return{}},delSessByTypeId:function(e,n){return!0},resetCookieAndSyncFlag:function(){},downloadMap:{}}};return function(n){var t,o={VERSION:"1.7.2",APPID:"537048168",PLAATFORM:"10"},r=!0,i={FORMAL:{COMMON:"https://webim.tim.qq.com",PIC:"https://pic.tim.qq.com"},TEST:{COMMON:"https://test.tim.qq.com",PIC:"https://pic.tim.qq.com"}},s={},u={OPEN_IM:"openim",GROUP:"group_open_http_svc",FRIEND:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",PIC:"openpic",BIG_GROUP:"group_open_http_noauth_svc",BIG_GROUP_LONG_POLLING:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",DEL_CHAT:"recentcontact",WEB_IM:"webim"},a={openim:"v4",group_open_http_svc:"v4",sns:"v4",profile:"v4",recentcontact:"v4",openpic:"v4",group_open_http_noauth_svc:"v1",group_open_long_polling_http_noauth_svc:"v1",imopenstat:"v4",webim:"v3"},c={login:1,pic_up:3,apply_join_group:9,create_group:10,longpolling:18,send_group_msg:19,sendmsg:20},l={C2C:"C2C",GROUP:"GROUP"},p={C2C:1,GROUP:2},f={C2C:12e3,GROUP:8898},g={OK:"OK",FAIL:"FAIL"},d={TEXT:"TIMTextElem",FACE:"TIMFaceElem",IMAGE:"TIMImageElem",CUSTOM:"TIMCustomElem",SOUND:"TIMSoundElem",FILE:"TIMFileElem",LOCATION:"TIMLocationElem",GROUP_TIP:"TIMGroupTipElem"},m={ORIGIN:1,LARGE:2,SMALL:3},I={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},M={RAW_DATA:0,BASE64_DATA:1},E={BUSSINESS_ID:"10001",AUTH_KEY:"617574686b6579",SERVER_IP:"182.140.186.147"},_={SOUND:2106,FILE:2107},y={IMAGE:1,FILE:2,SHORT_VIDEO:3,SOUND:4},h={APP_VERSION:"2.1",SERVER_VERSION:1},T={C2C:1,GROUP_COMMON:3,GROUP_TIP:4,GROUP_SYSTEM:5,GROUP_TIP2:6,FRIEND_NOTICE:7,PROFILE_NOTICE:8,C2C_COMMON:9,C2C_EVENT:10},C={COMMON:0},A={READED:92,KICKEDOUT:96},S={COMMON:0,LOVEMSG:1,TIP:2,REDPACKET:3},G={REDPACKET:1,COMMON:2,LOVEMSG:3},F={JOIN:1,QUIT:2,KICK:3,SET_ADMIN:4,CANCEL_ADMIN:5,MODIFY_GROUP_INFO:6,MODIFY_MEMBER_INFO:7},O={FACE_URL:1,NAME:2,OWNER:3,NOTIFICATION:4,INTRODUCTION:5},R={JOIN_GROUP_REQUEST:1,JOIN_GROUP_ACCEPT:2,JOIN_GROUP_REFUSE:3,KICK:4,DESTORY:5,CREATE:6,INVITED_JOIN_GROUP_REQUEST:7,QUIT:8,SET_ADMIN:9,CANCEL_ADMIN:10,REVOKE:11,READED:15,CUSTOM:255,INVITED_JOIN_GROUP_REQUEST_AGREE:12},N={FRIEND_ADD:1,FRIEND_DELETE:2,PENDENCY_ADD:3,PENDENCY_DELETE:4,BLACK_LIST_ADD:5,BLACK_LIST_DELETE:6,PENDENCY_REPORT:7,FRIEND_UPDATE:8},v={PROFILE_MODIFY:1},P={OK:0,SIGNATURE_EXPIRATION:11},U={INIT:-1,ON:0,RECONNECT:1,OFF:9999},b={GROUP_MSG:1,C2C_MSG:2,USER_HEAD:3,GROUP_HEAD:4},L={ING:14,STOP:15},D=U.INIT,w=!1,k=0,q=6e4,x=null,B=0,K=0,H=[],z=null,J=null,V={sdkAppID:null,appIDAt3rd:null,accountType:null,identifier:null,tinyid:null,identifierNick:null,userSig:null,a2:null,contentType:"json",apn:1},Y={},X=0,W={},j=0,Q=[],$=[],Z=[],ee={downloadMap:{}},ne={"[惊讶]":0,"[撇嘴]":1,"[色]":2,"[发呆]":3,"[得意]":4,"[流泪]":5,"[害羞]":6,"[闭嘴]":7,"[睡]":8,"[大哭]":9,"[尴尬]":10,"[发怒]":11,"[调皮]":12,"[龇牙]":13,"[微笑]":14,"[难过]":15,"[酷]":16,"[冷汗]":17,"[抓狂]":18,"[吐]":19,"[偷笑]":20,"[可爱]":21,"[白眼]":22,"[傲慢]":23,"[饿]":24,"[困]":25,"[惊恐]":26,"[流汗]":27,"[憨笑]":28,"[大兵]":29,"[奋斗]":30,"[咒骂]":31,"[疑问]":32,"[嘘]":33,"[晕]":34},te={},oe=new function(){this.formatTimeStamp=function(e,n){if(!e)return 0;var t;n=n||"yyyy-MM-dd hh:mm:ss";var o=new Date(1e3*e),r={"M+":o.getMonth()+1,"d+":o.getDate(),"h+":o.getHours(),"m+":o.getMinutes(),"s+":o.getSeconds()};t=/(y+)/.test(n)?n.replace(RegExp.$1,(o.getFullYear()+"").substr(4-RegExp.$1.length)):n;for(var i in r)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("00"+r[i]).substr((""+r[i]).length)));return t},this.groupTypeEn2Ch=function(e){var n=null;switch(e){case"Public":n="公开群";break;case"ChatRoom":n="聊天室";break;case"Private":n="私有群";break;case"AVChatRoom":n="直播聊天室";break;default:n=e}return n},this.groupTypeCh2En=function(e){var n=null;switch(e){case"公开群":n="Public";break;case"聊天室":n="ChatRoom";break;case"私有群":n="Private";break;case"直播聊天室":n="AVChatRoom";break;default:n=e}return n},this.groupRoleEn2Ch=function(e){var n=null;switch(e){case"Member":n="成员";break;case"Admin":n="管理员";break;case"Owner":n="群主";break;default:n=e}return n},this.groupRoleCh2En=function(e){var n=null;switch(e){case"成员":n="Member";break;case"管理员":n="Admin";break;case"群主":n="Owner";break;default:n=e}return n},this.groupMsgFlagEn2Ch=function(e){var n=null;switch(e){case"AcceptAndNotify":n="接收并提示";break;case"AcceptNotNotify":n="接收不提示";break;case"Discard":n="屏蔽";break;default:n=e}return n},this.groupMsgFlagCh2En=function(e){var n=null;switch(e){case"接收并提示":n="AcceptAndNotify";break;case"接收不提示":n="AcceptNotNotify";break;case"屏蔽":n="Discard";break;default:n=e}return n},this.formatText2Html=function(e){var n=e;return n&&(n=this.xssFilter(n),n=n.replace(/ /g,"&nbsp;"),n=n.replace(/\n/g,"<br/>")),n},this.formatHtml2Text=function(e){var n=e;return n&&(n=n.replace(/&nbsp;/g," "),n=n.replace(/<br\/>/g,"\n")),n},this.getStrBytes=function(e){if(null==e||void 0===e)return 0;if("string"!=typeof e)return 0;var n,t,o,r=0;for(t=0,o=e.length;t<o;t++)n=e.charCodeAt(t),r+=n<=127?1:n<=2047?2:n<=65535?3:4;return r},this.xssFilter=function(e){return e=e.toString(),e=e.replace(/[<]/g,"&lt;"),e=e.replace(/[>]/g,"&gt;"),e=e.replace(/"/g,"&quot;")},this.trimStr=function(e){return e?(e=e.toString(),e.replace(/(^\s*)|(\s*$)/g,"")):""},this.validNumber=function(e){return e=e.toString(),e.match(/(^\d{1,8}$)/g)},this.getReturnError=function(e,n){return n||(n=-100),{ActionStatus:g.FAIL,ErrorCode:n,ErrorInfo:e+"["+n+"]"}},this.replaceObject=function(e,n){for(var t in n)if(e[t])if(n[e[t]]=n[t],delete n[t],n[e[t]]instanceof Array)for(var o=n[e[t]].length,r=0;r<o;r++)n[e[t]][r]=this.replaceObject(e,n[e[t]][r]);else"object"==typeof n[e[t]]&&(n[e[t]]=this.replaceObject(e,n[e[t]]));return n}},re=new function(){var e=!0;this.setOn=function(n){e=n},this.getOn=function(){return e},this.error=function(n){try{e&&console.error(n)}catch(e){}},this.warn=function(n){try{e&&console.warn(n)}catch(e){}},this.info=function(n){try{e&&console.info(n)}catch(e){}},this.debug=function(n){try{e&&console.debug(n)}catch(e){}}},ie=function(e){return e||(e=new Date),Math.round(e.getTime()/1e3)},se=function(){return j?j+=1:j=Math.round(1e7*Math.random()),j},ue=function(){return Math.round(4294967296*Math.random())},ae=function(e,n,t,o,r,i,s){wx.request({url:n,data:t,dataType:"json",method:e,header:{"Content-Type":"application/json"},success:function(e){k=B=0,i&&i(e.data)},fail:function(e){setTimeout(function(){var e=oe.getReturnError("请求服务器失败,请检查你的网络是否正常",-2);s&&s(e)},16)}})},ce=function(e,n,t,o,r,i,s){ae(e,n,JSON.stringify(t),0,0,function(e){var n=null;e&&(n=e),i&&i(n)},s)},le=function(){return V.sdkAppID&&V.identifier},pe=function(e,n){if(!le()){if(n){var t=oe.getReturnError("请登录",-4);e&&e(t)}return!1}return!0},fe=function(){return r},ge=function(e,n,t,r){var s=i;s=fe()?i.FORMAL.COMMON:i.TEST.COMMON,e==u.PIC&&(s=fe()?i.FORMAL.PIC:i.TEST.PIC);var c=s+"/"+a[e]+"/"+e+"/"+n+"?websdkappid="+o.APPID+"&v="+o.VERSION+"&platform="+o.PLAATFORM;if(le()){if("login"==n||"accesslayer"==n)c+="&identifier="+encodeURIComponent(V.identifier)+"&usersig="+V.userSig;else if(V.tinyid&&V.a2)c+="&tinyid="+V.tinyid+"&a2="+V.a2;else if(r)return re.error("tinyid或a2为空["+e+"]["+n+"]"),r(oe.getReturnError("tinyid或a2为空["+e+"]["+n+"]",-5)),!1;c+="&contenttype="+V.contentType}return c+="&sdkappid="+V.sdkAppID+"&accounttype="+V.accountType+"&apn="+V.apn+"&reqtime="+ie()},de=function(e,n){var t=null;return z&&H[0]?t="http://"+H[0]+"/asn.com/stddownload_common_file?authkey="+z+"&bid="+E.BUSSINESS_ID+"&subbid="+V.sdkAppID+"&fileid="+e+"&filetype="+_.SOUND+"&openid="+n+"&ver=0":re.error("拼接语音下载url不报错：ip或者authkey为空"),t},me=function(e,n,t){var o=null;return z&&H[0]?o="http://"+H[0]+"/asn.com/stddownload_common_file?authkey="+z+"&bid="+E.BUSSINESS_ID+"&subbid="+V.sdkAppID+"&fileid="+e+"&filetype="+_.FILE+"&openid="+n+"&ver=0&filename="+encodeURIComponent(t):re.error("拼接文件下载url不报错：ip或者authkey为空"),ee.downloadMap["uuid_"+e]=o,o},Ie=function(e,n,t,o,r,i,s){var u={From_Account:n,To_Account:r,os_platform:10,Timestamp:ie().toString(),Random:ue().toString(),request_info:[{busi_id:i,download_flag:o,type:s,uuid:e,version:h.SERVER_VERSION,auth_key:z,ip:H[0]}]};Cn(u,function(e){0==e.error_code&&e.response_info&&(ee.downloadMap["uuid_"+u.uuid]=e.response_info.url),onAppliedDownloadUrl&&onAppliedDownloadUrl({uuid:u.uuid,url:e.response_info.url,maps:ee.downloadMap})},function(e){re.error("获取下载地址失败",u.uuid)})},Me=function(){for(var e in W){var n=W[e];n&&(n.abort(),W[X]=null)}X=0,W={}},Ee=function(){Me(),V={sdkAppID:null,appIDAt3rd:null,accountType:null,identifier:null,identifierNick:null,userSig:null,contentType:"json",apn:1},Y={},j=0,Z=[],Rn.clear(),On.clear(),x=null},_e=function(e,n,t,o,i){return Ee(),t&&(Y=t),0==Y.isAccessFormalEnv&&(re.error("请切换为正式环境！！！！"),r=Y.isAccessFormalEnv),0==Y.isLogOn&&re.setOn(Y.isLogOn),!e&&i?void i(oe.getReturnError("loginInfo is empty",-6)):!e.sdkAppID&&i?void i(oe.getReturnError("loginInfo.sdkAppID is empty",-7)):!e.accountType&&i?void i(oe.getReturnError("loginInfo.accountType is empty",-8)):(e.identifier&&(V.identifier=e.identifier.toString()),e.identifier&&!e.userSig&&i?void i(oe.getReturnError("loginInfo.userSig is empty",-9)):(e.userSig&&(V.userSig=e.userSig.toString()),V.sdkAppID=e.sdkAppID,V.accountType=e.accountType,void(V.identifier&&V.userSig?he(function(){Te(function(e,t){Rn.init(n,function(n){o&&(n.identifierNick=e,n.headurl=t,o(n))},i)},i)}):Rn.init(n,o,i))))},ye=function(e,n,t){if("longpolling"!=e||60008!=n&&91101!=n){var r=c[e];if(r){var i=ie(),s=null,u={Code:n,ErrMsg:t};if(V.a2?s=V.a2.substring(0,10)+"_"+i+"_"+ue():V.userSig&&(s=V.userSig.substring(0,10)+"_"+i+"_"+ue()),s){var a={UniqKey:s,EventId:r,ReportTime:i,MsgCmdErrorCode:u};if("login"==e){var l=[];l.push(a);hn({EvtItems:l,MainVersion:o.VERSION,Version:"0"},function(e){l=null},function(e){l=null})}else if(Z.push(a),Z.length>=20){var p={EvtItems:Z,MainVersion:o.VERSION,Version:"0"};hn(p,function(e){Z=[]},function(e){Z=[]})}}}}},he=function(e){An.apiCall(u.WEB_IM,"accesslayer",{},function(n){0===n.ErrorCode&&1===n.WebImAccessLayer&&(i.FORMAL.COMMON="https://events.tim.qq.com"),e()},function(){e()})},Te=function(e,n){An.apiCall(u.OPEN_IM,"login",{State:"Online"},function(t){if(t.TinyId)V.tinyid=t.TinyId;else if(n)return void n(oe.getReturnError("TinyId is empty",-10));if(t.A2Key)V.a2=t.A2Key;else if(n)return void n(oe.getReturnError("A2Key is empty",-11));var o=["Tag_Profile_IM_Nick","Tag_Profile_IM_Image"],r={From_Account:V.identifier,To_Account:[V.identifier],LastStandardSequence:0,TagList:o};gn(r,function(n){var t,o;if(n.UserProfileItem&&n.UserProfileItem.length>0)for(var r in n.UserProfileItem)for(var i in n.UserProfileItem[r].ProfileItem)switch(n.UserProfileItem[r].ProfileItem[i].Tag){case"Tag_Profile_IM_Nick":t=n.UserProfileItem[r].ProfileItem[i].Value,t&&(V.identifierNick=t);break;case"Tag_Profile_IM_Image":o=n.UserProfileItem[r].ProfileItem[i].Value,o&&(V.headurl=o)}e&&e(V.identifierNick,V.headurl)},n)},n)},Ce=function(e,n,t){if(!pe(t,!1))return Ee(),void(n&&n({ActionStatus:g.OK,ErrorCode:0,ErrorInfo:"logout success"}));"all"==e?An.apiCall(u.OPEN_IM,"logout",{},function(e){Ee(),n&&n(e)},t):An.apiCall(u.OPEN_IM,"longpollinglogout",{LongPollingId:x},function(e){Ee(),n&&n(e)},t)},Ae=function(e,n,t){if(pe(t,!0)){var o=null;switch(e.sess.type()){case l.C2C:o={From_Account:V.identifier,To_Account:e.sess.id().toString(),MsgTimeStamp:e.time,MsgSeq:e.seq,MsgRandom:e.random,MsgBody:[],OfflinePushInfo:e.offlinePushInfo};break;case l.GROUP:var r=e.getSubType();switch(o={GroupId:e.sess.id().toString(),From_Account:V.identifier,Random:e.random,MsgBody:[]},r){case S.COMMON:o.MsgPriority="COMMON";break;case S.REDPACKET:o.MsgPriority="REDPACKET";break;case S.LOVEMSG:o.MsgPriority="LOVEMSG";break;case S.TIP:re.error("不能主动发送群提示消息,subType="+r);break;default:return void re.error("发送群消息时，出现未知子消息类型：subType="+r)}}for(var i in e.elems){var s=e.elems[i],a=null,c=s.type;switch(c){case d.TEXT:a={Text:s.content.text};break;case d.FACE:a={Index:s.content.index,Data:s.content.data};break;case d.IMAGE:var p=[];for(var f in s.content.ImageInfoArray)p.push({Type:s.content.ImageInfoArray[f].type,Size:s.content.ImageInfoArray[f].size,Width:s.content.ImageInfoArray[f].width,Height:s.content.ImageInfoArray[f].height,URL:s.content.ImageInfoArray[f].url});a={ImageFormat:s.content.ImageFormat,UUID:s.content.UUID,ImageInfoArray:p};break;case d.SOUND:re.warn("web端暂不支持发送语音消息");continue;case d.LOCATION:re.warn("web端暂不支持发送地理位置消息");continue;case d.FILE:a={UUID:s.content.uuid,FileName:s.content.name,FileSize:s.content.size,DownloadFlag:s.content.downFlag};break;case d.CUSTOM:a={Data:s.content.data,Desc:s.content.desc,Ext:s.content.ext},c=d.CUSTOM;break;default:re.warn("web端暂不支持发送"+s.type+"消息");continue}e.PushInfoBoolean&&(o.OfflinePushInfo=e.PushInfo),o.MsgBody.push({MsgType:c,MsgContent:a})}e.sess.type()==l.C2C?An.apiCall(u.OPEN_IM,"sendmsg",o,n,t):e.sess.type()==l.GROUP&&An.apiCall(u.GROUP,"send_group_msg",o,n,t)}},Se=function(e,n,t){(r||"undefined"==typeof stopPolling||1!=stopPolling)&&pe(t,!0)&&An.apiCall(u.OPEN_IM,"longpolling",e,n,t,q,!0)},Ge=function(e,n,t,o){An.apiCall(u.BIG_GROUP_LONG_POLLING,"get_msg",e,n,t,o)},Fe=function(e,n,t,o){pe(o,!0)&&An.apiCall(u.OPEN_IM,"getmsg",{Cookie:e,SyncFlag:n},function(e){if(e.MsgList&&e.MsgList.length)for(var n in e.MsgList)Q.push(e.MsgList[n]);1==e.SyncFlag?Fe(e.Cookie,e.SyncFlag,t,o):(e.MsgList=Q,Q=[],t&&t(e))},o)},Oe=function(e,n,t,o){if(pe(o,!0)){var r=[];for(var i in n){var s={To_Account:n[i].toAccount,LastedMsgTime:n[i].lastedMsgTime};r.push(s)}An.apiCall(u.OPEN_IM,"msgreaded",{C2CMsgReaded:{Cookie:e,C2CMsgReadedItem:r}},t,o)}},Re=function(e,n,t){pe(t,!0)&&An.apiCall(u.OPEN_IM,"deletemsg",e,n,t)},Ne=function(e,n,t){pe(t,!0)&&An.apiCall(u.OPEN_IM,"getroammsg",e,function(o){var r=e.MaxCnt,i=o.Complete,s=o.MaxCnt,u=o.MsgKey,a=o.LastMsgTime;if(o.MsgList&&o.MsgList.length)for(var c in o.MsgList)$.push(o.MsgList[c]);var l=null;0==i&&s<r&&(l={Peer_Account:e.Peer_Account,MaxCnt:r-s,LastMsgTime:a,MsgKey:u}),l?Ne(l,n,t):(o.MsgList=$,$=[],n&&n(o))},t)},ve=function(e,n,t){if(pe(t,!0)){for(var o={Type:e.Type,Name:e.Name},r=[],i=0;i<e.MemberList.length;i++)r.push({Member_Account:e.MemberList[i]});o.MemberList=r,e.GroupId&&(o.GroupId=e.GroupId),e.Owner_Account&&(o.Owner_Account=e.Owner_Account),e.Introduction&&(o.Introduction=e.Introduction),e.Notification&&(o.Notification=e.Notification),e.MaxMemberCount&&(o.MaxMemberCount=e.MaxMemberCount),e.ApplyJoinOption&&(o.ApplyJoinOption=e.ApplyJoinOption),e.AppDefinedData&&(o.AppDefinedData=e.AppDefinedData),e.FaceUrl&&(o.FaceUrl=e.FaceUrl),An.apiCall(u.GROUP,"create_group",o,n,t)}},Pe=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"create_group",e,n,t)},Ue=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"modify_group_base_info",e,n,t)},be=function(e,n,t){pe(t,!0)&&(e.GroupId=String(e.GroupId),An.apiCall(u.GROUP,"apply_join_group",{GroupId:e.GroupId,ApplyMsg:e.ApplyMsg,UserDefinedField:e.UserDefinedField},n,t))},Le=function(e,n,o){e.GroupId=String(e.GroupId),t=e.GroupId;var r;r=pe(o,!1)?u.GROUP:u.BIG_GROUP,An.apiCall(r,"apply_join_group",{GroupId:e.GroupId,ApplyMsg:e.ApplyMsg,UserDefinedField:e.UserDefinedField},function(t){if(t.JoinedStatus&&"JoinedSuccess"==t.JoinedStatus){if(!t.LongPollingKey)return void(o&&o(oe.getReturnError("Join Group succeed; But the type of group is not AVChatRoom: groupid="+e.GroupId,-12)));Rn.setBigGroupLongPollingOn(!0),Rn.setBigGroupLongPollingKey(t.LongPollingKey),Rn.setBigGroupLongPollingMsgMap(e.GroupId,0),Rn.bigGroupLongPolling()}n&&n(t)},function(e){o&&o(e)})},De=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"handle_apply_join_group",{GroupId:e.GroupId,Applicant_Account:e.Applicant_Account,HandleMsg:e.HandleMsg,Authentication:e.Authentication,MsgKey:e.MsgKey,ApprovalMsg:e.ApprovalMsg,UserDefinedField:e.UserDefinedField},n,function(e){if(10024==e.ErrorCode){if(n){var o={ActionStatus:g.OK,ErrorCode:0,ErrorInfo:"该申请已经被处理过"};n(o)}}else t&&t(e)})},we=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"get_pendency",{StartTime:e.StartTime,Limit:e.Limit,Handle_Account:V.identifier},n,function(e){})},ke=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"report_pendency",{ReportTime:e.ReportTime,From_Account:V.identifier},n,function(e){})},qe=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"handle_invite_join_group",{GroupId:e.GroupId,Inviter_Account:e.Inviter_Account,HandleMsg:e.HandleMsg,Authentication:e.Authentication,MsgKey:e.MsgKey,ApprovalMsg:e.ApprovalMsg,UserDefinedField:e.UserDefinedField},n,function(e){})},xe=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"quit_group",{GroupId:e.GroupId},n,t)},Be=function(e,n,t){var o;o=pe(t,!1)?u.GROUP:u.BIG_GROUP,Rn.resetBigGroupLongPollingInfo(),An.apiCall(o,"quit_group",{GroupId:e.GroupId},function(t){On.delSessByTypeId(l.GROUP,e.GroupId),n&&n(t)},t)},Ke=function(e,n,t){An.apiCall(u.GROUP,"search_group",e,n,t)},He=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"get_group_public_info",{GroupIdList:e.GroupIdList,ResponseFilter:{GroupBasePublicInfoFilter:e.GroupBasePublicInfoFilter}},function(e){if(e.ErrorInfo="",e.GroupInfo)for(var o in e.GroupInfo){var r=e.GroupInfo[o].ErrorCode;r>0&&(e.ActionStatus=g.FAIL,e.GroupInfo[o].ErrorInfo="["+r+"]"+e.GroupInfo[o].ErrorInfo,e.ErrorInfo+=e.GroupInfo[o].ErrorInfo+"\n")}e.ActionStatus==g.FAIL?t&&t(e):n&&n(e)},t)},ze=function(e,n,t){if(pe(t,!0)){var o={GroupIdList:e.GroupIdList,ResponseFilter:{GroupBaseInfoFilter:e.GroupBaseInfoFilter,MemberInfoFilter:e.MemberInfoFilter}};e.AppDefinedDataFilter_Group&&(o.ResponseFilter.AppDefinedDataFilter_Group=e.AppDefinedDataFilter_Group),e.AppDefinedDataFilter_GroupMember&&(o.ResponseFilter.AppDefinedDataFilter_GroupMember=e.AppDefinedDataFilter_GroupMember),An.apiCall(u.GROUP,"get_group_info",o,n,t)}},Je=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"get_group_member_info",{GroupId:e.GroupId,Offset:e.Offset,Limit:e.Limit,MemberInfoFilter:e.MemberInfoFilter,MemberRoleFilter:e.MemberRoleFilter,AppDefinedDataFilter_GroupMember:e.AppDefinedDataFilter_GroupMember},n,t)},Ve=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"add_group_member",{GroupId:e.GroupId,Silence:e.Silence,MemberList:e.MemberList},n,t)},Ye=function(e,n,t){if(pe(t,!0)){var o={};e.GroupId&&(o.GroupId=e.GroupId),e.Member_Account&&(o.Member_Account=e.Member_Account),e.Role&&(o.Role=e.Role),e.MsgFlag&&(o.MsgFlag=e.MsgFlag),e.ShutUpTime&&(o.ShutUpTime=e.ShutUpTime),e.NameCard&&(o.NameCard=e.NameCard),e.AppMemberDefinedData&&(o.AppMemberDefinedData=e.AppMemberDefinedData),An.apiCall(u.GROUP,"modify_group_member_info",o,n,t)}},Xe=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"delete_group_member",{GroupId:e.GroupId,Silence:e.Silence,MemberToDel_Account:e.MemberToDel_Account,Reason:e.Reason},n,t)},We=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"destroy_group",{GroupId:e.GroupId},n,t)},je=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"change_group_owner",e,n,t)},Qe=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"get_joined_group_list",{Member_Account:e.Member_Account,Limit:e.Limit,Offset:e.Offset,GroupType:e.GroupType,ResponseFilter:{GroupBaseInfoFilter:e.GroupBaseInfoFilter,SelfInfoFilter:e.SelfInfoFilter}},n,t)},$e=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"get_role_in_group",{GroupId:e.GroupId,User_Account:e.User_Account},n,t)},Ze=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"forbid_send_msg",{GroupId:e.GroupId,Members_Account:e.Members_Account,ShutUpTime:e.ShutUpTime},n,t)},en=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"send_group_system_notification",e,n,t)},nn=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"group_msg_get",{GroupId:e.GroupId,ReqMsgSeq:e.ReqMsgSeq,ReqMsgNumber:e.ReqMsgNumber},n,t)},tn=function(e,n,t){pe(t,!0)&&An.apiCall(u.GROUP,"msg_read_report",{GroupId:e.GroupId,MsgReadedSeq:e.MsgReadedSeq},n,t)},on=function(e){var n=[];if(e.Fail_Account&&e.Fail_Account.length&&(n=e.Fail_Account),e.Invalid_Account&&e.Invalid_Account.length)for(var t in e.Invalid_Account)n.push(e.Invalid_Account[t]);if(n.length){e.ActionStatus=g.FAIL,e.ErrorCode=99999,e.ErrorInfo="";for(var o in n){var r=n[o];for(var i in e.ResultItem)if(e.ResultItem[i].To_Account==r){var s=e.ResultItem[i].ResultCode;e.ResultItem[i].ResultInfo="["+s+"]"+e.ResultItem[i].ResultInfo,e.ErrorInfo+=e.ResultItem[i].ResultInfo+"\n";break}}}return e},rn=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"friend_add",{From_Account:V.identifier,AddFriendItem:e.AddFriendItem},function(e){var o=on(e);o.ActionStatus==g.FAIL?t&&t(o):n&&n(o)},t)},sn=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"friend_delete",{From_Account:V.identifier,To_Account:e.To_Account,DeleteType:e.DeleteType},function(e){var o=on(e);o.ActionStatus==g.FAIL?t&&t(o):n&&n(o)},t)},un=function(e,n,t){pe(t,!0)&&(1==e.chatType?An.apiCall(u.DEL_CHAT,"delete",{From_Account:V.identifier,Type:e.chatType,To_Account:e.To_Account},n,t):An.apiCall(u.DEL_CHAT,"delete",{From_Account:V.identifier,Type:e.chatType,ToGroupid:e.To_Account},n,t))},an=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"pendency_get",{From_Account:V.identifier,PendencyType:e.PendencyType,StartTime:e.StartTime,MaxLimited:e.MaxLimited,LastSequence:e.LastSequence},n,t)},cn=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"PendencyReport",{From_Account:V.identifier,LatestPendencyTimeStamp:e.LatestPendencyTimeStamp},n,t)},ln=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"pendency_delete",{From_Account:V.identifier,PendencyType:e.PendencyType,To_Account:e.To_Account},function(e){var o=on(e);o.ActionStatus==g.FAIL?t&&t(o):n&&n(o)},t)},pn=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"friend_response",{From_Account:V.identifier,ResponseFriendItem:e.ResponseFriendItem},function(e){var o=on(e);o.ActionStatus==g.FAIL?t&&t(o):n&&n(o)},t)},fn=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"friend_get_all",{From_Account:V.identifier,TimeStamp:e.TimeStamp,StartIndex:e.StartIndex,GetCount:e.GetCount,LastStandardSequence:e.LastStandardSequence,TagList:e.TagList},n,t)},gn=function(e,n,t){e.To_Account.length>100&&(e.To_Account.length=100,re.error("获取用户资料人数不能超过100人")),pe(t,!0)&&An.apiCall(u.PROFILE,"portrait_get",{From_Account:V.identifier,To_Account:e.To_Account,TagList:e.TagList},function(e){var o=[];if(e.Fail_Account&&e.Fail_Account.length&&(o=e.Fail_Account),e.Invalid_Account&&e.Invalid_Account.length)for(var r in e.Invalid_Account)o.push(e.Invalid_Account[r]);if(o.length){e.ActionStatus=g.FAIL,e.ErrorCode=99999,e.ErrorInfo="";for(var i in o){var s=o[i];for(var u in e.UserProfileItem)if(e.UserProfileItem[u].To_Account==s){var a=e.UserProfileItem[u].ResultCode;e.UserProfileItem[u].ResultInfo="["+a+"]"+e.UserProfileItem[u].ResultInfo,e.ErrorInfo+="账号:"+s+","+e.UserProfileItem[u].ResultInfo+"\n";break}}}e.ActionStatus==g.FAIL?t&&t(e):n&&n(e)},t)},dn=function(e,n,t){pe(t,!0)&&An.apiCall(u.PROFILE,"portrait_set",{From_Account:V.identifier,ProfileItem:e.ProfileItem},function(t){for(var o in e.ProfileItem){var r=e.ProfileItem[o];if("Tag_Profile_IM_Nick"==r.Tag){V.identifierNick=r.Value;break}}n&&n(t)},t)},mn=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"black_list_add",{From_Account:V.identifier,To_Account:e.To_Account},function(e){var o=on(e);o.ActionStatus==g.FAIL?t&&t(o):n&&n(o)},t)},In=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"black_list_delete",{From_Account:V.identifier,To_Account:e.To_Account},function(e){var o=on(e);o.ActionStatus==g.FAIL?t&&t(o):n&&n(o)},t)},Mn=function(e,n,t){pe(t,!0)&&An.apiCall(u.FRIEND,"black_list_get",{From_Account:V.identifier,StartIndex:e.StartIndex,MaxLimited:e.MaxLimited,LastSequence:e.LastSequence},n,t)},En=function(e,n,t){pe(t,!0)&&An.apiCall(u.RECENT_CONTACT,"get",{From_Account:V.identifier,Count:e.Count},n,t)},_n=function(e,n,t){if(pe(t,!0)){var o;o=fe()?"pic_up":"pic_up_test",An.apiCall(u.PIC,o,{App_Version:h.APP_VERSION,From_Account:V.identifier,To_Account:e.To_Account,Seq:e.Seq,Timestamp:e.Timestamp,Random:e.Random,File_Str_Md5:e.File_Str_Md5,File_Size:e.File_Size,File_Type:e.File_Type,Server_Ver:h.SERVER_VERSION,Auth_Key:z,Busi_Id:e.Busi_Id,PkgFlag:e.PkgFlag,Slice_Offset:e.Slice_Offset,Slice_Size:e.Slice_Size,Slice_Data:e.Slice_Data},n,t)}},yn=function(e,n){pe(n,!0)&&An.apiCall(u.OPEN_IM,"authkey",{},e,n)},hn=function(e,n,t){pe(t,!0)&&An.apiCall(u.IM_OPEN_STAT,"web_report",e,n,t)},Tn=function(e,n,t){pe(t,!0)&&An.apiCall(u.OPEN_IM,"getlongpollingid",{},function(e){n&&n(e)},t)},Cn=function(e,n,t){An.apiCall(u.PIC,"apply_download",e,n,t)};!function(){s="wechat"}();var An=new function(){var e=null;this.init=function(n,t,o){n&&(e=n)},this.callBack=function(n){e&&e(n)},this.clear=function(){e=null},this.apiCall=function(e,n,t,o,r,i,s){var u=ge(e,n,0,r);0!=u&&ce("POST",u,t,0,0,function(i){var s=null,a="";"pic_up"==n&&(t.Slice_Data="");var c="\n request url: \n"+u+"\n request body: \n"+JSON.stringify(t)+"\n response: \n"+JSON.stringify(i);i.ActionStatus==g.OK?(re.info("["+e+"]["+n+"]success: "+c),o&&o(i),s=0,a=""):(s=i.ErrorCode,a=i.ErrorInfo,r&&(i.SrcErrorInfo=i.ErrorInfo,i.ErrorInfo="["+e+"]["+n+"]failed: "+c,"longpolling"==n&&60008==i.ErrorCode||re.error(i.ErrorInfo),r(i))),ye(n,s,a)},function(e){r&&r(e),ye(n,e.ErrorCode,e.ErrorInfo)})}},Sn=function(e,n,t,o,r,i){this._impl={skey:Sn.skey(e,n),type:e,id:n,name:t,icon:o,unread:0,isAutoRead:!1,time:r>=0?r:0,curMaxMsgSeq:i>=0?i:0,msgs:[],isFinished:1}};Sn.skey=function(e,n){return e+n},Sn.prototype.type=function(){return this._impl.type},Sn.prototype.id=function(){return this._impl.id},Sn.prototype.name=function(){return this._impl.name},Sn.prototype.icon=function(){return this._impl.icon},Sn.prototype.unread=function(e){if(void 0===e)return this._impl.unread;this._impl.unread=e},Sn.prototype.isFinished=function(e){if(void 0===e)return this._impl.isFinished;this._impl.isFinished=e},Sn.prototype.time=function(){return this._impl.time},Sn.prototype.curMaxMsgSeq=function(e){if(void 0===e)return this._impl.curMaxMsgSeq;this._impl.curMaxMsgSeq=e},Sn.prototype.msgCount=function(){return this._impl.msgs.length},Sn.prototype.msg=function(e){return this._impl.msgs[e]},Sn.prototype.msgs=function(){return this._impl.msgs},Sn.prototype._impl_addMsg=function(e,n){this._impl.msgs.push(e),e.time>this._impl.time&&(this._impl.time=e.time),e.seq>this._impl.curMaxMsgSeq&&(this._impl.curMaxMsgSeq=e.seq),e.isSend||this._impl.isAutoRead||!n||this._impl.unread++};var Gn=function(e,n){this.toAccount=e,this.lastedMsgTime=n},Fn=function(e,n,t,o,r,i,s,u,a){this.sess=e,this.subType=s>=0?s:0,this.fromAccount=i,this.fromAccountNick=u||i,this.fromAccountHeadurl=a||null,this.isSend=Boolean(n),this.seq=t>=0?t:se(),this.random=o>=0?o:ue(),this.time=r>=0?r:ie(),this.elems=[];var c=e.type()};Fn.prototype.getSession=function(){return this.sess},Fn.prototype.getType=function(){return this.subType},Fn.prototype.getSubType=function(){return this.subType},Fn.prototype.getFromAccount=function(){return this.fromAccount},Fn.prototype.getFromAccountNick=function(){return this.fromAccountNick},Fn.prototype.getIsSend=function(){return this.isSend},Fn.prototype.getSeq=function(){return this.seq},Fn.prototype.getTime=function(){return this.time},Fn.prototype.getRandom=function(){return this.random},Fn.prototype.getElems=function(){return this.elems},Fn.prototype.getMsgUniqueId=function(){return this.uniqueId},Fn.prototype.addText=function(e){this.addElem(new n.Msg.Elem(d.TEXT,e))},Fn.prototype.addFace=function(e){this.addElem(new n.Msg.Elem(d.FACE,e))},Fn.prototype.addImage=function(e){this.addElem(new n.Msg.Elem(d.IMAGE,e))},Fn.prototype.addLocation=function(e){this.addElem(new n.Msg.Elem(d.LOCATION,e))},Fn.prototype.addFile=function(e){this.addElem(new n.Msg.Elem(d.FILE,e))},Fn.prototype.addCustom=function(e){this.addElem(new n.Msg.Elem(d.CUSTOM,e))},Fn.prototype.addElem=function(e){this.elems.push(e)},Fn.prototype.toHtml=function(){var e="";for(var n in this.elems){e+=this.elems[n].toHtml()}return e},Fn.Elem=function(e,n){this.type=e,this.content=n},Fn.Elem.prototype.getType=function(){return this.type},Fn.Elem.prototype.getContent=function(){return this.content},Fn.Elem.prototype.toHtml=function(){return this.content.toHtml()},Fn.Elem.Text=function(e){this.text=oe.xssFilter(e)},Fn.Elem.Text.prototype.getText=function(){return this.text},Fn.Elem.Text.prototype.toHtml=function(){return this.text},Fn.Elem.Face=function(e,n){this.index=e,this.data=n},Fn.Elem.Face.prototype.getIndex=function(){return this.index},Fn.Elem.Face.prototype.getData=function(){return this.data},Fn.Elem.Face.prototype.toHtml=function(){var e=null,n=ne[this.data],t=te[n];return t&&t[1]&&(e=t[1]),e?"<img src='"+e+"'/>":this.data},Fn.Elem.Location=function(e,n,t){this.latitude=n,this.longitude=e,this.desc=t},Fn.Elem.Location.prototype.getLatitude=function(){return this.latitude},Fn.Elem.Location.prototype.getLongitude=function(){return this.longitude},Fn.Elem.Location.prototype.getDesc=function(){return this.desc},Fn.Elem.Location.prototype.toHtml=function(){return"经度="+this.longitude+",纬度="+this.latitude+",描述="+this.desc},Fn.Elem.Images=function(e,n){this.UUID=e,"number"!=typeof n&&(n=parseInt(I[n]||I.UNKNOWN,10)),this.ImageFormat=n,this.ImageInfoArray=[]},Fn.Elem.Images.prototype.addImage=function(e){this.ImageInfoArray.push(e)},Fn.Elem.Images.prototype.toHtml=function(){var e=this.getImage(m.SMALL),n=this.getImage(m.LARGE),t=this.getImage(m.ORIGIN);return n||(n=e),t||(t=e),"<img src='"+e.getUrl()+"#"+n.getUrl()+"#"+t.getUrl()+"' style='CURSOR: hand' id='"+this.getImageId()+"' bigImgUrl='"+n.getUrl()+"' onclick='imageClick(this)' />"},Fn.Elem.Images.prototype.getImageId=function(){return this.UUID},Fn.Elem.Images.prototype.getImageFormat=function(){return this.ImageFormat},Fn.Elem.Images.prototype.getImage=function(e){for(var n in this.ImageInfoArray)if(this.ImageInfoArray[n].getType()==e)return this.ImageInfoArray[n];var t=null;return this.ImageInfoArray.forEach(function(n){n.getType()==e&&(t=n)}),t},Fn.Elem.Images.Image=function(e,n,t,o,r){this.type=e,this.size=n,this.width=t,this.height=o,this.url=r},Fn.Elem.Images.Image.prototype.getType=function(){return this.type},Fn.Elem.Images.Image.prototype.getSize=function(){return this.size},Fn.Elem.Images.Image.prototype.getWidth=function(){return this.width},Fn.Elem.Images.Image.prototype.getHeight=function(){return this.height},Fn.Elem.Images.Image.prototype.getUrl=function(){return this.url},Fn.Elem.Sound=function(e,n,t,o,r,i,s){this.uuid=e,this.second=n,this.size=t,this.senderId=o,this.receiverId=r,this.downFlag=i,this.busiId=s==l.C2C?2:1,void 0!==this.downFlag&&void 0!==this.busiId?Ie(e,o,0,i,r,this.busiId,y.SOUND):this.downUrl=de(e,o)},
Fn.Elem.Sound.prototype.getUUID=function(){return this.uuid},Fn.Elem.Sound.prototype.getSecond=function(){return this.second},Fn.Elem.Sound.prototype.getSize=function(){return this.size},Fn.Elem.Sound.prototype.getSenderId=function(){return this.senderId},Fn.Elem.Sound.prototype.getDownUrl=function(){return this.downUrl},Fn.Elem.Sound.prototype.toHtml=function(){return"ie"==s.type&&parseInt(s.ver)<=8?"[这是一条语音消息]demo暂不支持ie8(含)以下浏览器播放语音,语音URL:"+this.downUrl:'<audio id="uuid_'+this.uuid+'" src="'+this.downUrl+'" controls="controls" onplay="onChangePlayAudio(this)" preload="none"></audio>'},Fn.Elem.File=function(e,n,t,o,r,i,s){this.uuid=e,this.name=n,this.size=t,this.senderId=o,this.receiverId=r,this.downFlag=i,this.busiId=s==l.C2C?2:1,void 0!==i&&void 0!==busiId?Ie(e,o,0,i,r,this.busiId,y.FILE):this.downUrl=me(e,o,n)},Fn.Elem.File.prototype.getUUID=function(){return this.uuid},Fn.Elem.File.prototype.getName=function(){return this.name},Fn.Elem.File.prototype.getSize=function(){return this.size},Fn.Elem.File.prototype.getSenderId=function(){return this.senderId},Fn.Elem.File.prototype.getDownUrl=function(){return this.downUrl},Fn.Elem.File.prototype.getDownFlag=function(){return this.downFlag},Fn.Elem.File.prototype.toHtml=function(){var e,n;return e=this.size,n="Byte",this.size>=1024&&(e=Math.round(this.size/1024),n="KB"),{uuid:this.uuid,name:this.name,size:e,unitStr:n}},Fn.Elem.GroupTip=function(e,n,t,o,r,i){this.opType=e,this.opUserId=n,this.groupId=t,this.groupName=o,this.userIdList=r||[],this.groupInfoList=[],this.memberInfoList=[],this.groupMemberNum=null,this.userinfo=i||[]},Fn.Elem.GroupTip.prototype.addGroupInfo=function(e){this.groupInfoList.push(e)},Fn.Elem.GroupTip.prototype.addMemberInfo=function(e){this.memberInfoList.push(e)},Fn.Elem.GroupTip.prototype.getOpType=function(){return this.opType},Fn.Elem.GroupTip.prototype.getOpUserId=function(){return this.opUserId},Fn.Elem.GroupTip.prototype.getGroupId=function(){return this.groupId},Fn.Elem.GroupTip.prototype.getGroupName=function(){return this.groupName},Fn.Elem.GroupTip.prototype.getUserIdList=function(){return this.userIdList},Fn.Elem.GroupTip.prototype.getUserInfo=function(){return this.userinfo},Fn.Elem.GroupTip.prototype.getGroupInfoList=function(){return this.groupInfoList},Fn.Elem.GroupTip.prototype.getMemberInfoList=function(){return this.memberInfoList},Fn.Elem.GroupTip.prototype.getGroupMemberNum=function(){return this.groupMemberNum},Fn.Elem.GroupTip.prototype.setGroupMemberNum=function(e){return this.groupMemberNum=e},Fn.Elem.GroupTip.prototype.toHtml=function(){var e="[群提示消息]";switch(this.opType){case F.JOIN:e+=this.opUserId+"邀请了";for(var n in this.userIdList)if(e+=this.userIdList[n]+",",this.userIdList.length>10&&9==n){e+="等"+this.userIdList.length+"人";break}e+="加入该群";break;case F.QUIT:e+=this.opUserId+"主动退出该群";break;case F.KICK:e+=this.opUserId+"将";for(var n in this.userIdList)if(e+=this.userIdList[n]+",",this.userIdList.length>10&&9==n){e+="等"+this.userIdList.length+"人";break}e+="踢出该群";break;case F.SET_ADMIN:e+=this.opUserId+"将";for(var n in this.userIdList)if(e+=this.userIdList[n]+",",this.userIdList.length>10&&9==n){e+="等"+this.userIdList.length+"人";break}e+="设为管理员";break;case F.CANCEL_ADMIN:e+=this.opUserId+"取消";for(var n in this.userIdList)if(e+=this.userIdList[n]+",",this.userIdList.length>10&&9==n){e+="等"+this.userIdList.length+"人";break}e+="的管理员资格";break;case F.MODIFY_GROUP_INFO:e+=this.opUserId+"修改了群资料：";for(var n in this.groupInfoList){var t=this.groupInfoList[n].getType(),o=this.groupInfoList[n].getValue();switch(t){case O.FACE_URL:e+="群头像为"+o+"; ";break;case O.NAME:e+="群名称为"+o+"; ";break;case O.OWNER:e+="群主为"+o+"; ";break;case O.NOTIFICATION:e+="群公告为"+o+"; ";break;case O.INTRODUCTION:e+="群简介为"+o+"; ";break;default:e+="未知信息为:type="+t+",value="+o+"; "}}break;case F.MODIFY_MEMBER_INFO:e+=this.opUserId+"修改了群成员资料:";for(var n in this.memberInfoList){var r=this.memberInfoList[n].getUserId(),i=this.memberInfoList[n].getShutupTime();if(e+=r+": ",e+=null!=i&&void 0!==i?0==i?"取消禁言; ":"禁言"+i+"秒; ":" shutupTime为空",this.memberInfoList.length>10&&9==n){e+="等"+this.memberInfoList.length+"人";break}}break;case F.READED:Log.info("消息已读同步");break;default:e+="未知群提示消息类型：type="+this.opType}return e},Fn.Elem.GroupTip.GroupInfo=function(e,n){this.type=e,this.value=n},Fn.Elem.GroupTip.GroupInfo.prototype.getType=function(){return this.type},Fn.Elem.GroupTip.GroupInfo.prototype.getValue=function(){return this.value},Fn.Elem.GroupTip.MemberInfo=function(e,n){this.userId=e,this.shutupTime=n},Fn.Elem.GroupTip.MemberInfo.prototype.getUserId=function(){return this.userId},Fn.Elem.GroupTip.MemberInfo.prototype.getShutupTime=function(){return this.shutupTime},Fn.Elem.Custom=function(e,n,t){this.data=e,this.desc=n,this.ext=t},Fn.Elem.Custom.prototype.getData=function(){return this.data},Fn.Elem.Custom.prototype.getDesc=function(){return this.desc},Fn.Elem.Custom.prototype.getExt=function(){return this.ext},Fn.Elem.Custom.prototype.toHtml=function(){return this.data};var On=new function(){var n={},t=[];e={},this.cookie="",this.syncFlag=0;var o=function(e){for(var t in n)e(n[t])},r=function(n){var t=!1,o=n.sess._impl.skey,r=n.isSend+n.seq+n.random;return e[o]&&e[o][r]&&(t=!0),e[o]?e[o][r]={time:n.time}:(e[o]={},e[o][r]={time:n.time}),t};this.sessMap=function(){return n},this.sessCount=function(){return t.length},this.sessByTypeId=function(e,t){var o=Sn.skey(e,t);return void 0===o||null==o?null:n[o]},this.delSessByTypeId=function(t,o){var r=Sn.skey(t,o);return void 0!==r&&null!=r&&(n[r]&&(delete n[r],delete e[r]),!0)},this.resetCookieAndSyncFlag=function(){this.cookie="",this.syncFlag=0},this.setAutoRead=function(e,n,t){if(t&&o(function(e){e._impl.isAutoRead=!1}),e&&(e._impl.isAutoRead=n,n))if(e._impl.unread=0,e._impl.type==l.C2C){var r=[];r.push(new Gn(e._impl.id,e._impl.time)),Oe(On.cookie,r,function(e){re.info("[setAutoRead]: c2CMsgReaded success")},function(e){re.error("[setAutoRead}: c2CMsgReaded failed:"+e.ErrorInfo)})}else if(e._impl.type==l.GROUP){var i={GroupId:e._impl.id,MsgReadedSeq:e._impl.curMaxMsgSeq};tn(i,function(e){re.info("groupMsgReaded success")},function(e){re.error("groupMsgReaded failed:"+e.ErrorInfo)})}},this.c2CMsgReaded=function(e,n,t){var o=[];o.push(new Gn(e.To_Account,e.LastedMsgTime)),Oe(On.cookie,o,function(e){n&&(re.info("c2CMsgReaded success"),n(e))},function(e){t&&(re.error("c2CMsgReaded failed:"+e.ErrorInfo),t(e))})},this.addSession=function(e){n[e._impl.skey]=e},this.delSession=function(e){delete n[e._impl.skey]},this.clear=function(){n={},t=[],e={},this.cookie="",this.syncFlag=0},this.addMsg=function(e,t){if(r(e))return!1;var o=e.sess;return n[o._impl.skey]||this.addSession(o),o._impl_addMsg(e,t),!0},this.updateTimeline=function(){var e=new Array;o(function(n){e.push(n)}),e.sort(function(e,n){return n.time-e.time}),t=e}},Rn=new function(){var e=null,n=null,o={1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:null,11:null,15:null,255:null,12:null},r={1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null},i={1:null},s=null,u=!1,a=0,c=0,p=null,f=!1,m=0,I=90,M=null,E={},_={92:null,96:null},y=null,h=0,P={},b={};this.setLongPollingOn=function(e){u=e},this.getLongPollingOn=function(){return u},this.resetLongPollingInfo=function(){u=!1,a=0,c=0},this.setBigGroupLongPollingOn=function(e){f=e},this.setBigGroupLongPollingKey=function(e){M=e},this.resetBigGroupLongPollingInfo=function(){f=!1,m=0,M=null,E={}},this.setBigGroupLongPollingMsgMap=function(e,n){var t=E[e];t?(t=parseInt(t)+n,E[e]=t):E[e]=n},this.clear=function(){n=null,o={1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:null,11:null,15:null,255:null,12:null},r={1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null},i={1:null},e=null,u=!1,a=0,c=0,p=null,f=!1,m=0,M=null,E={},b={},H=[],z=null,J=null};var K=function(e,n){yn(function(n){H=n.IpList,z=n.AuthKey,J=n.ExpireTime,e&&e(n)},function(e){re.error("initIpAndAuthkey failed:"+e.ErrorInfo),n&&n(e)})},Y=function(e,n){var t={Member_Account:V.identifier,Limit:1e3,Offset:0,GroupBaseInfoFilter:["NextMsgSeq"]};Qe(t,function(n){if(!n.GroupIdList||0==n.GroupIdList.length)return re.info("initMyGroupMaxSeqs: 目前还没有加入任何群组"),void(e&&e(n));for(var t=0;t<n.GroupIdList.length;t++){var o=n.GroupIdList[t].GroupId,r=n.GroupIdList[t].NextMsgSeq-1;P[o]=r}e&&e(n)},function(e){re.error("initMyGroupMaxSeqs failed:"+e.ErrorInfo),n&&n(e)})},X=function(e,n,t){h++;var o={GroupId:e,ReqMsgSeq:n,ReqMsgNumber:t};re.warn("第"+h+"次补齐群消息,参数="+JSON.stringify(o)),Rn.syncGroupMsgs(o)},W=function(e,n){var t=P[e];t?n>t&&(P[e]=n):P[e]=n},j=function(e,n){for(var t in e){var o=e[t];if(o.From_Account){var r=le(o,!1,!0);r&&n.push(r),W(o.ToGroupId,o.MsgSeq)}}return n},Q=function(n,t){var o={},r=[];for(var i in t){var s=o[t[i].ToGroupId];s||(s=o[t[i].ToGroupId]={min:99999999,max:-1,msgs:[]}),t[i].NoticeSeq>c&&(re.warn("noticeSeq="+c+",msgNoticeSeq="+t[i].NoticeSeq),c=t[i].NoticeSeq),t[i].Event=n,o[t[i].ToGroupId].msgs.push(t[i]),t[i].MsgSeq<s.min&&(o[t[i].ToGroupId].min=t[i].MsgSeq),t[i].MsgSeq>s.max&&(o[t[i].ToGroupId].max=t[i].MsgSeq)}for(var u in o){var a=o[u].max-o[u].min+1,l=P[u];l?o[u].min-l>1||o[u].msgs.length<a?(re.warn("发起一次补齐群消息请求,curMaxMsgSeq="+l+", minMsgSeq="+o[u].min+", maxMsgSeq="+o[u].max+", msgs.length="+o[u].msgs.length+", tempCount="+a),X(u,o[u].max,o[u].max-l),W(u,o[u].max)):r=j(o[u].msgs,r):(re.warn("不存在该群的最大消息seq，群id="+u),o[u].msgs.length<a?(re.warn("发起一次补齐群消息请求,minMsgSeq="+o[u].min+", maxMsgSeq="+o[u].max+", msgs.length="+o[u].msgs.length+", tempCount="+a),X(u,o[u].max,a),W(u,o[u].max)):r=j(o[u].msgs,r))}r.length&&On.updateTimeline(),e&&r.length&&e(r)},$=function(n,t){var o={},r=[];for(var i in t){var s=o[t[i].ToGroupId];s||(s=o[t[i].ToGroupId]={min:99999999,max:-1,msgs:[]}),t[i].NoticeSeq>c&&(re.warn("noticeSeq="+c+",msgNoticeSeq="+t[i].NoticeSeq),c=t[i].NoticeSeq),t[i].Event=n,o[t[i].ToGroupId].msgs.push(t[i]),t[i].MsgSeq<s.min&&(o[t[i].ToGroupId].min=t[i].MsgSeq),t[i].MsgSeq>s.max&&(o[t[i].ToGroupId].max=t[i].MsgSeq)}for(var u in o){var a=o[u].max-o[u].min+1,l=P[u];l?o[u].min-l>1||o[u].msgs.length<a?(re.warn("发起一次补齐群消息请求,curMaxMsgSeq="+l+", minMsgSeq="+o[u].min+", maxMsgSeq="+o[u].max+", msgs.length="+o[u].msgs.length+", tempCount="+a),X(u,o[u].max,o[u].max-l),W(u,o[u].max)):r=j(o[u].msgs,r):(re.warn("不存在该群的最大消息seq，群id="+u),o[u].msgs.length<a?(re.warn("发起一次补齐群消息请求,minMsgSeq="+o[u].min+", maxMsgSeq="+o[u].max+", msgs.length="+o[u].msgs.length+", tempCount="+a),X(u,o[u].max,a),W(u,o[u].max)):r=j(o[u].msgs,r))}r.length&&On.updateTimeline(),e&&r.length&&e(r)},Z=function(e,n){for(var t in e){var r=e[t],i=r.MsgBody,s=i.ReportType;0==n&&r.NoticeSeq&&r.NoticeSeq>c&&(c=r.NoticeSeq);r.GroupInfo.To_Account;if(n){var u=r.ToGroupId+"_"+s+"_"+i.Operator_Account;if(b[u]){re.warn("收到重复的群系统消息：key="+u);continue}b[u]=!0}var a={SrcFlag:0,ReportType:s,GroupId:r.ToGroupId,GroupName:r.GroupInfo.GroupName,Operator_Account:i.Operator_Account,MsgTime:r.MsgTimeStamp,groupReportTypeMsg:i};switch(s){case R.JOIN_GROUP_REQUEST:a.RemarkInfo=i.RemarkInfo,a.MsgKey=i.MsgKey,a.Authentication=i.Authentication,a.UserDefinedField=r.UserDefinedField,a.From_Account=r.From_Account,a.MsgSeq=r.ClientSeq,a.MsgRandom=r.MsgRandom;break;case R.JOIN_GROUP_ACCEPT:case R.JOIN_GROUP_REFUSE:a.RemarkInfo=i.RemarkInfo;break;case R.KICK:case R.DESTORY:case R.CREATE:case R.INVITED_JOIN_GROUP_REQUEST:case R.INVITED_JOIN_GROUP_REQUEST_AGREE:case R.QUIT:case R.SET_ADMIN:case R.CANCEL_ADMIN:case R.REVOKE:case R.READED:break;case R.CUSTOM:a.MsgSeq=r.MsgSeq,a.UserDefinedField=i.UserDefinedField;break;default:re.error("未知群系统消息类型：reportType="+s)}if(n)o[s]?o[s](a):re.error("未知群系统消息类型：reportType="+s);else if(o[s])if(s==R.READED)for(var l=a.groupReportTypeMsg.GroupReadInfoArray,p=0,f=l.length;p<f;p++){var g=l[p];o[s](g)}else o[s](a)}},ee=function(e,n){var t,o,i;for(var s in e){switch(t=e[s],o=t.PushType,0==n&&t.NoticeSeq&&t.NoticeSeq>c&&(c=t.NoticeSeq),i={Type:o},o){case N.FRIEND_ADD:i.Accounts=t.FriendAdd_Account;break;case N.FRIEND_DELETE:i.Accounts=t.FriendDel_Account;break;case N.PENDENCY_ADD:i.PendencyList=t.PendencyAdd;break;case N.PENDENCY_DELETE:i.Accounts=t.FrienPencydDel_Account;break;case N.BLACK_LIST_ADD:i.Accounts=t.BlackListAdd_Account;break;case N.BLACK_LIST_DELETE:i.Accounts=t.BlackListDel_Account;break;default:re.error("未知好友系统通知类型：friendNotice="+JSON.stringify(t))}n?o==N.PENDENCY_ADD&&r[o]&&r[o](i):r[o]&&r[o](i)}},ne=function(e,n){var t,o,r;for(var s in e){switch(t=e[s],o=t.PushType,0==n&&t.NoticeSeq&&t.NoticeSeq>c&&(c=t.NoticeSeq),r={Type:o},o){case v.PROFILE_MODIFY:r.Profile_Account=t.Profile_Account,r.ProfileList=t.ProfileList;break;default:re.error("未知资料系统通知类型：profileNotice="+JSON.stringify(t))}n?o==v.PROFILE_MODIFY&&i[o]&&i[o](r):i[o]&&i[o](r)}},te=function(e){var n=e.MsgBody,t=n.ReportType,r=(e.GroupInfo.To_Account,{SrcFlag:1,ReportType:t,GroupId:e.ToGroupId,GroupName:e.GroupInfo.GroupName,Operator_Account:n.Operator_Account,MsgTime:e.MsgTimeStamp});switch(t){case R.JOIN_GROUP_REQUEST:r.RemarkInfo=n.RemarkInfo,r.MsgKey=n.MsgKey,r.Authentication=n.Authentication,r.UserDefinedField=e.UserDefinedField,r.From_Account=e.From_Account,r.MsgSeq=e.ClientSeq,r.MsgRandom=e.MsgRandom;break;case R.JOIN_GROUP_ACCEPT:case R.JOIN_GROUP_REFUSE:r.RemarkInfo=n.RemarkInfo;break;case R.KICK:case R.DESTORY:case R.CREATE:case R.INVITED_JOIN_GROUP_REQUEST:case R.INVITED_JOIN_GROUP_REQUEST_AGREE:case R.QUIT:case R.SET_ADMIN:case R.CANCEL_ADMIN:case R.REVOKE:break;case R.CUSTOM:r.MsgSeq=e.MsgSeq,r.UserDefinedField=n.UserDefinedField;break;default:re.error("未知群系统消息类型：reportType="+t)}o[t]&&o[t](r)},ie=function(e){for(var n=0,t=e.length;n<t;n++)se(e[n])},se=function(e){console.error(e);var n=e.SubMsgType;switch(n){case A.READED:if(re.warn("C2C已读消息通知"),e.ReadC2cMsgNotify&&e.ReadC2cMsgNotify.UinPairReadArray&&_[n])for(var t=0,o=e.ReadC2cMsgNotify.UinPairReadArray.length;t<o;t++){var r=e.ReadC2cMsgNotify.UinPairReadArray[t];_[n](r)}break;case A.KICKEDOUT:re.warn("多终端互踢通知"),Ce("instance"),_[n]&&_[n]();break;default:re.error("未知C2c系统消息：subType="+n)}};this.longPolling=function(e,n){function t(){Se(o,function(e){for(var n in e.EventArray){var t=e.EventArray[n];switch(t.Event){case T.C2C:a=t.NotifySeq,re.warn("longpolling: received new c2c msg"),Rn.syncMsgs();break;case T.GROUP_COMMON:re.warn("longpolling: received new group msgs"),$(t.Event,t.GroupMsgArray);break;case T.GROUP_TIP:case T.GROUP_TIP2:re.warn("longpolling: received new group tips"),$(t.Event,t.GroupTips);break;case T.GROUP_SYSTEM:re.warn("longpolling: received new group system msgs"),Z(t.GroupTips,!1);break;case T.FRIEND_NOTICE:re.warn("longpolling: received new friend system notice"),ee(t.FriendListMod,!1);break;case T.PROFILE_NOTICE:re.warn("longpolling: received new profile system notice"),ne(t.ProfileDataMod,!1);break;case T.C2C_COMMON:c=t.C2cMsgArray[0].NoticeSeq,re.warn("longpolling: received new c2c_common msg",c),Q(t.Event,t.C2cMsgArray);break;case T.C2C_EVENT:c=t.C2cNotifyMsgArray[0].NoticeSeq,re.warn("longpolling: received new c2c_event msg"),ie(t.C2cNotifyMsgArray);break;default:re.error("longpolling收到未知新消息类型: Event="+t.Event)}}var o={ActionStatus:g.OK,ErrorCode:0};ue(o)},function(e){ue(e),n&&n(e)})}var o={Timeout:q/1e3,Cookie:{NotifySeq:a,NoticeSeq:c}};x?(o.Cookie.LongPollingId=x,t()):Tn(0,function(e){x=o.Cookie.LongPollingId=e.LongPollingId,q=e.Timeout>60?q:1e3*e.Timeout,t()})},this.bigGroupLongPolling=function(e,n){var o=t;Ge({USP:1,StartSeq:m,HoldTime:I,Key:M},function(n){if(o==t){var r=[];if(m=n.NextSeq,I=n.HoldTime,M=n.Key,n.RspMsgList&&n.RspMsgList.length>0){for(var i,s,u,a=0,c=n.RspMsgList.length-1;c>=0;c--){i=n.RspMsgList[c];var l={F_Account:"From_Account",T_Account:"To_Account",FAType:"EnumFrom_AccountType",TAType:"EnumTo_AccountType",GCode:"GroupCode",GName:"GroupName",GId:"GroupId",MFlg:"MsgFlag",FAEInfo:"MsgFrom_AccountExtraInfo",Evt:"Event",GInfo:"GroupInfo",BPlc:"IsPlaceMsg",MBody:"MsgBody",Pri:"MsgPriority",Rdm:"MsgRandom",MSeq:"MsgSeq",TStp:"MsgTimeStamp",TGId:"ToGroupId",UEInfo:"UinExtInfo",UId:"UserId",BSys:"IsSystemMsg",FAHUrl:"From_AccountHeadurl",FANick:"From_AccountNick"};if(i=oe.replaceObject(l,i),!i.IsPlaceMsg&&i.From_Account&&i.MsgBody&&0!=i.MsgBody.length)switch(s=i.Event){case T.GROUP_COMMON:re.info("bigGroupLongPolling: return new group msg"),u=le(i,!1,!1),u&&r.push(u),a+=1;break;case T.GROUP_TIP:case T.GROUP_TIP2:re.info("bigGroupLongPolling: return new group tip"),(u=le(i,!1,!1))&&r.push(u);break;case T.GROUP_SYSTEM:re.info("bigGroupLongPolling: new group system msg"),te(i);break;default:re.error("bigGroupLongPolling收到未知新消息类型: Event="+s)}}a>0&&(Rn.setBigGroupLongPollingMsgMap(i.ToGroupId,a),re.warn("current bigGroupLongPollingMsgMap: "+JSON.stringify(E)))}B=0;var d={ActionStatus:g.OK,ErrorCode:U.ON,ErrorInfo:"connection is ok..."};An.callBack(d),e?e(r):p&&p(r),f&&Rn.bigGroupLongPolling()}},function(e){if(10018==e.ErrorCode?m=0:60008!=e.ErrorCode&&(re.error(e.ErrorInfo),B++),91101==e.ErrorCode&&(re.error("多实例登录，被kick"),s&&s()),B<10)f&&Rn.bigGroupLongPolling();else{var t={ActionStatus:g.FAIL,ErrorCode:U.OFF,ErrorInfo:"connection is off"};An.callBack(t)}n&&n(e)},1e3*I)};var ue=function(e){if(0==e.ErrorCode||60008==e.ErrorCode){k=0,w=!1;var n,t=!1;switch(D){case U.INIT:t=!0,D=U.ON,n="create connection successfully(INIT->ON)";break;case U.ON:n="connection is on...(ON->ON)";break;case U.RECONNECT:D=U.ON,n="connection is on...(RECONNECT->ON)";break;case U.OFF:t=!0,D=U.RECONNECT,n="reconnect successfully(OFF->RECONNECT)"}var o={ActionStatus:g.OK,ErrorCode:D,ErrorInfo:n};t&&An.callBack(o),u&&Rn.longPolling()}else if(91101==e.ErrorCode)re.error("多实例登录，被kick"),s&&s();else if(k++,re.warn("longPolling接口第"+k+"次报错: "+e.ErrorInfo),k<=10)setTimeout(ae,100);else{D=U.OFF;var r={ActionStatus:g.FAIL,ErrorCode:U.OFF,ErrorInfo:"connection is off"};0==w&&An.callBack(r),w=!0,re.warn("5000毫秒之后,SDK会发起新的longPolling请求..."),setTimeout(ae,5e3)}},Q=function(n,t){var o=[],r=[];r=t;for(var i in r){var s,u,a=r[i],c=a.From_AccountHeadurl||"";a.From_Account==V.identifier?(s=!0,u=a.To_Account):(s=!1,u=a.From_Account);var p=On.sessByTypeId(l.C2C,u);p||(p=new Sn(l.C2C,u,u,c,0,0));var f=new Fn(p,s,a.MsgSeq,a.MsgRandom,a.MsgTimeStamp,a.From_Account,C.COMMON,a.From_AccountNick,c),g=null,m=null,I=null;for(var M in a.MsgBody){switch(g=a.MsgBody[M],I=g.MsgType){case d.TEXT:m=new Fn.Elem.Text(g.MsgContent.Text);break;case d.FACE:m=new Fn.Elem.Face(g.MsgContent.Index,g.MsgContent.Data);break;case d.IMAGE:m=new Fn.Elem.Images(g.MsgContent.UUID,g.MsgContent.ImageFormat||"");for(var E in g.MsgContent.ImageInfoArray){var _=g.MsgContent.ImageInfoArray[E];m.addImage(new Fn.Elem.Images.Image(_.Type,_.Size,_.Width,_.Height,_.URL))}break;case d.SOUND:g.MsgContent?m=new Fn.Elem.Sound(g.MsgContent.UUID,g.MsgContent.Second,g.MsgContent.Size,a.From_Account,a.To_Account,g.MsgContent.Download_Flag,l.C2C):(I=d.TEXT,m=new Fn.Elem.Text("[语音消息]下载地址解析出错"));break;case d.LOCATION:m=new Fn.Elem.Location(g.MsgContent.Longitude,g.MsgContent.Latitude,g.MsgContent.Desc);break;case d.FILE:case d.FILE+" ":I=d.FILE,g.MsgContent?m=new Fn.Elem.File(g.MsgContent.UUID,g.MsgContent.FileName,g.MsgContent.FileSize,a.From_Account,a.To_Account,g.MsgContent.Download_Flag,l.C2C):(I=d.TEXT,m=new Fn.Elem.Text("[文件消息下载地址解析出错]"));break;case d.CUSTOM:try{var y=JSON.parse(g.MsgContent.Data);if(y&&y.userAction&&y.userAction==L.ING)continue}catch(e){}I=d.CUSTOM,m=new Fn.Elem.Custom(g.MsgContent.Data,g.MsgContent.Desc,g.MsgContent.Ext);break;default:I=d.TEXT,m=new Fn.Elem.Text("web端暂不支持"+g.MsgType+"消息")}f.elems.push(new Fn.Elem(I,m))}f.elems.length>0&&On.addMsg(f,!0)&&o.push(f)}o.length>0&&On.updateTimeline(),o.length>0&&e&&e(o)},ae=function(){u&&Rn.longPolling()},ce=function(e){for(var n in e){var t=e[n];switch(Z(t.GroupTips,!0),t.Event){case T.GROUP_SYSTEM:re.warn("handlerApplyJoinGroupSystemMsgs： handler new group system msg"),Z(t.GroupTips,!0);break;default:re.error("syncMsgs收到未知的群系统消息类型: Event="+t.Event)}}};this.syncMsgs=function(n,t){var o=[],r=[];Fe(On.cookie,On.syncFlag,function(t){2==t.SyncFlag&&(On.syncFlag=0),r=t.MsgList,On.cookie=t.Cookie;for(var i in r){var s,u,a,c=r[i];c.From_Account==V.identifier?(s=!0,u=c.To_Account,a=""):(s=!1,u=c.From_Account,a="");var p=On.sessByTypeId(l.C2C,u);p||(p=new Sn(l.C2C,u,u,a,0,0));var f=new Fn(p,s,c.MsgSeq,c.MsgRandom,c.MsgTimeStamp,c.From_Account,C.COMMON,c.From_AccountNick,c.From_AccountHeadurl),g=null,m=null,I=null;for(var M in c.MsgBody){switch(g=c.MsgBody[M],I=g.MsgType){case d.TEXT:m=new Fn.Elem.Text(g.MsgContent.Text);break;case d.FACE:m=new Fn.Elem.Face(g.MsgContent.Index,g.MsgContent.Data);break;case d.IMAGE:m=new Fn.Elem.Images(g.MsgContent.UUID,g.MsgContent.ImageFormat);for(var E in g.MsgContent.ImageInfoArray){var _=g.MsgContent.ImageInfoArray[E];m.addImage(new Fn.Elem.Images.Image(_.Type,_.Size,_.Width,_.Height,_.URL))}break;case d.SOUND:g.MsgContent?m=new Fn.Elem.Sound(g.MsgContent.UUID,g.MsgContent.Second,g.MsgContent.Size,c.From_Account,c.To_Account,g.MsgContent.Download_Flag,l.C2C):(I=d.TEXT,m=new Fn.Elem.Text("[语音消息]下载地址解析出错"));break;case d.LOCATION:m=new Fn.Elem.Location(g.MsgContent.Longitude,g.MsgContent.Latitude,g.MsgContent.Desc);break;case d.FILE:case d.FILE+" ":I=d.FILE,g.MsgContent?m=new Fn.Elem.File(g.MsgContent.UUID,g.MsgContent.FileName,g.MsgContent.FileSize,c.From_Account,c.To_Account,g.MsgContent.Download_Flag,l.C2C):(I=d.TEXT,m=new Fn.Elem.Text("[文件消息下载地址解析出错]"));break;case d.CUSTOM:try{var y=JSON.parse(g.MsgContent.Data);if(y&&y.userAction&&y.userAction==L.ING)continue}catch(e){}I=d.CUSTOM,m=new Fn.Elem.Custom(g.MsgContent.Data,g.MsgContent.Desc,g.MsgContent.Ext);break;default:I=d.TEXT,m=new Fn.Elem.Text("web端暂不支持"+g.MsgType+"消息")}f.elems.push(new Fn.Elem(I,m))}f.elems.length>0&&On.addMsg(f,!0)&&o.push(f)}ce(t.EventArray),o.length>0&&On.updateTimeline(),n?n(o):o.length>0&&e&&e(o)},function(e){re.error("getMsgs failed:"+e.ErrorInfo),t&&t(e)})},this.getC2CHistoryMsgs=function(e,n,t){if(!e.Peer_Account&&t)return void t(oe.getReturnError("Peer_Account is empty",-13));if(e.MaxCnt||(e.MaxCnt=15),e.MaxCnt<=0&&t)return void t(oe.getReturnError("MaxCnt should be greater than 0",-14));if(e.MaxCnt>15){if(t)return void t(oe.getReturnError("MaxCnt can not be greater than 15",-15))}else{null!=e.MsgKey&&void 0!==e.MsgKey||(e.MsgKey="");var o={Peer_Account:e.Peer_Account,MaxCnt:e.MaxCnt,LastMsgTime:e.LastMsgTime,MsgKey:e.MsgKey};Ne(o,function(t){var o=[],r=[];r=t.MsgList;var i=On.sessByTypeId(l.C2C,e.Peer_Account);i||(i=new Sn(l.C2C,e.Peer_Account,e.Peer_Account,"",0,0));for(var s in r){var u,a=r[s],c=a.From_AccountHeadurl||"";a.From_Account==V.identifier?(u=!0,a.To_Account):(u=!1,a.From_Account);var p=new Fn(i,u,a.MsgSeq,a.MsgRandom,a.MsgTimeStamp,a.From_Account,C.COMMON,a.From_AccountNick,c),f=null,g=null,m=null;for(var I in a.MsgBody){switch(f=a.MsgBody[I],m=f.MsgType){case d.TEXT:g=new Fn.Elem.Text(f.MsgContent.Text);break;case d.FACE:g=new Fn.Elem.Face(f.MsgContent.Index,f.MsgContent.Data);break;case d.IMAGE:g=new Fn.Elem.Images(f.MsgContent.UUID,f.MsgContent.ImageFormat);for(var M in f.MsgContent.ImageInfoArray){var E=f.MsgContent.ImageInfoArray[M];g.addImage(new Fn.Elem.Images.Image(E.Type,E.Size,E.Width,E.Height,E.URL))}break;case d.SOUND:f.MsgContent?g=new Fn.Elem.Sound(f.MsgContent.UUID,f.MsgContent.Second,f.MsgContent.Size,a.From_Account,a.To_Account,f.MsgContent.Download_Flag,l.C2C):(m=d.TEXT,g=new Fn.Elem.Text("[语音消息]下载地址解析出错"));break;case d.LOCATION:g=new Fn.Elem.Location(f.MsgContent.Longitude,f.MsgContent.Latitude,f.MsgContent.Desc);break;case d.FILE:case d.FILE+" ":m=d.FILE,f.MsgContent?g=new Fn.Elem.File(f.MsgContent.UUID,f.MsgContent.FileName,f.MsgContent.FileSize,a.From_Account,a.To_Account,f.MsgContent.Download_Flag,l.C2C):(m=d.TEXT,g=new Fn.Elem.Text("[文件消息下载地址解析出错]"));break;case d.CUSTOM:m=d.CUSTOM,g=new Fn.Elem.Custom(f.MsgContent.Data,f.MsgContent.Desc,f.MsgContent.Ext);break;default:m=d.TEXT,g=new Fn.Elem.Text("web端暂不支持"+f.MsgType+"消息")}p.elems.push(new Fn.Elem(m,g))}On.addMsg(p),o.push(p)}if(On.updateTimeline(),n){var _={Complete:t.Complete,MsgCount:o.length,LastMsgTime:t.LastMsgTime,MsgKey:t.MsgKey,MsgList:o};i.isFinished(t.Complete),n(_)}},function(e){re.error("getC2CHistoryMsgs failed:"+e.ErrorInfo),t&&t(e)})}},this.syncGroupMsgs=function(n,t,o){if(n.ReqMsgSeq<=0){if(o){var r=oe.getReturnError("ReqMsgSeq must be greater than 0",-16);o(r)}}else{var i={GroupId:n.GroupId,ReqMsgSeq:n.ReqMsgSeq,ReqMsgNumber:n.ReqMsgNumber};nn(i,function(n){var o=[],r=(n.GroupId,n.RspMsgList),i=n.IsFinished;if(null==r||void 0===r)return void(t&&t([]));for(var s=r.length-1;s>=0;s--){var u=r[s];if(!u.IsPlaceMsg&&u.From_Account&&u.MsgBody&&0!=u.MsgBody.length){var a=le(u,!0,!0,i);a&&o.push(a)}}o.length>0&&On.updateTimeline(),t?t(o):o.length>0&&e&&e(o)},function(e){re.error("getGroupMsgs failed:"+e.ErrorInfo),o&&o(e)})}};var le=function(e,t,o,r){if(e.IsPlaceMsg||!e.From_Account||!e.MsgBody||0==e.MsgBody.length)return null;var i,s,u,a,c=e.ToGroupId,p=c;e.GroupInfo&&e.GroupInfo.GroupName&&(p=e.GroupInfo.GroupName),u=e.From_Account,e.GroupInfo&&(e.GroupInfo.From_AccountNick&&(u=e.GroupInfo.From_AccountNick),a=e.GroupInfo.From_AccountHeadurl?e.GroupInfo.From_AccountHeadurl:null),e.From_Account==V.identifier?(i=!0,e.From_Account,s=""):(i=!1,e.From_Account,s="");var f=On.sessByTypeId(l.GROUP,c);f||(f=new Sn(l.GROUP,c,p,s,0,0)),void 0!==r&&f.isFinished(r||0);var g=S.COMMON;if(T.GROUP_TIP==e.Event||T.GROUP_TIP2==e.Event){g=S.TIP;var m=e.MsgBody;e.MsgBody=[],e.MsgBody.push({MsgType:d.GROUP_TIP,MsgContent:m})}else e.MsgPriority&&(e.MsgPriority==G.REDPACKET?g=S.REDPACKET:e.MsgPriority==G.LOVEMSG&&(g=S.LOVEMSG));var I=new Fn(f,i,e.MsgSeq,e.MsgRandom,e.MsgTimeStamp,e.From_Account,g,u,a),M=null,E=null,_=null;for(var y in e.MsgBody){switch(M=e.MsgBody[y],_=M.MsgType){case d.TEXT:E=new Fn.Elem.Text(M.MsgContent.Text);break;case d.FACE:E=new Fn.Elem.Face(M.MsgContent.Index,M.MsgContent.Data);break;case d.IMAGE:E=new Fn.Elem.Images(M.MsgContent.UUID,M.MsgContent.ImageFormat||"");for(var h in M.MsgContent.ImageInfoArray)E.addImage(new Fn.Elem.Images.Image(M.MsgContent.ImageInfoArray[h].Type,M.MsgContent.ImageInfoArray[h].Size,M.MsgContent.ImageInfoArray[h].Width,M.MsgContent.ImageInfoArray[h].Height,M.MsgContent.ImageInfoArray[h].URL));break;case d.SOUND:M.MsgContent?E=new Fn.Elem.Sound(M.MsgContent.UUID,M.MsgContent.Second,M.MsgContent.Size,e.From_Account,e.To_Account,M.MsgContent.Download_Flag,l.GROUP):(_=d.TEXT,E=new Fn.Elem.Text("[语音消息]下载地址解析出错"));break;case d.LOCATION:E=new Fn.Elem.Location(M.MsgContent.Longitude,M.MsgContent.Latitude,M.MsgContent.Desc);break;case d.FILE:case d.FILE+" ":_=d.FILE;me(M.MsgContent.UUID,e.From_Account,M.MsgContent.FileName);M.MsgContent?E=new Fn.Elem.File(M.MsgContent.UUID,M.MsgContent.FileName,M.MsgContent.FileSize,e.From_Account,e.To_Account,M.MsgContent.Download_Flag,l.GROUP):(_=d.TEXT,E=new Fn.Elem.Text("[文件消息]地址解析出错"));break;case d.GROUP_TIP:var C=M.MsgContent.OpType;if(E=new Fn.Elem.GroupTip(C,M.MsgContent.Operator_Account,c,e.GroupInfo.GroupName,M.MsgContent.List_Account,M.MsgContent.MsgMemberExtraInfo),F.JOIN==C||F.QUIT==C)E.setGroupMemberNum(M.MsgContent.MemberNum);else if(F.MODIFY_GROUP_INFO==C){var A=!1,R={GroupId:c,GroupFaceUrl:null,GroupName:null,OwnerAccount:null,GroupNotification:null,GroupIntroduction:null},N=M.MsgContent.MsgGroupNewInfo;if(N.GroupFaceUrl){var v=new Fn.Elem.GroupTip.GroupInfo(O.FACE_URL,N.GroupFaceUrl);E.addGroupInfo(v),A=!0,R.GroupFaceUrl=N.GroupFaceUrl}if(N.GroupName){var P=new Fn.Elem.GroupTip.GroupInfo(O.NAME,N.GroupName);E.addGroupInfo(P),A=!0,R.GroupName=N.GroupName}if(N.Owner_Account){var U=new Fn.Elem.GroupTip.GroupInfo(O.OWNER,N.Owner_Account);E.addGroupInfo(U),A=!0,R.OwnerAccount=N.Owner_Account}if(N.GroupNotification){var b=new Fn.Elem.GroupTip.GroupInfo(O.NOTIFICATION,N.GroupNotification);E.addGroupInfo(b),A=!0,R.GroupNotification=N.GroupNotification}if(N.GroupIntroduction){var L=new Fn.Elem.GroupTip.GroupInfo(O.INTRODUCTION,N.GroupIntroduction);E.addGroupInfo(L),A=!0,R.GroupIntroduction=N.GroupIntroduction}0==t&&A&&n&&n(R)}else if(F.MODIFY_MEMBER_INFO==C){var D=M.MsgContent.MsgMemberInfo;for(var w in D){var k=D[w];E.addMemberInfo(new Fn.Elem.GroupTip.MemberInfo(k.User_Account,k.ShutupTime))}}break;case d.CUSTOM:_=d.CUSTOM,E=new Fn.Elem.Custom(M.MsgContent.Data,M.MsgContent.Desc,M.MsgContent.Ext);break;default:_=d.TEXT,E=new Fn.Elem.Text("web端暂不支持"+M.MsgType+"消息")}I.elems.push(new Fn.Elem(_,E))}return 0==o?I:On.addMsg(I,!0)?(I.extraInfo=e.GroupInfo.MsgFrom_AccountExtraInfo,I):null};this.init=function(t,a,c){if(t.onMsgNotify||re.warn("listeners.onMsgNotify is empty"),e=t.onMsgNotify,t.onBigGroupMsgNotify?p=t.onBigGroupMsgNotify:re.warn("listeners.onBigGroupMsgNotify is empty"),t.onC2cEventNotifys?_=t.onC2cEventNotifys:re.warn("listeners.onC2cEventNotifys is empty"),t.onGroupSystemNotifys?o=t.onGroupSystemNotifys:re.warn("listeners.onGroupSystemNotifys is empty"),t.onGroupInfoChangeNotify?n=t.onGroupInfoChangeNotify:re.warn("listeners.onGroupInfoChangeNotify is empty"),t.onFriendSystemNotifys?r=t.onFriendSystemNotifys:re.warn("listeners.onFriendSystemNotifys is empty"),t.onProfileSystemNotifys?i=t.onProfileSystemNotifys:re.warn("listeners.onProfileSystemNotifys is empty"),t.onKickedEventCall?s=t.onKickedEventCall:re.warn("listeners.onKickedEventCall is empty"),t.onLongPullingNotify?onLongPullingNotify=t.onLongPullingNotify:re.warn("listeners.onKickedEventCall is empty"),t.onAppliedDownloadUrl?y=t.onAppliedDownloadUrl:re.warn("listeners.onAppliedDownloadUrl is empty"),V.identifier&&V.userSig)Y(function(e){re.info("initMyGroupMaxSeqs success"),K(function(e){if(re.info("initIpAndAuthkey success"),a){re.info("login success(have login state))");var n={ActionStatus:g.OK,ErrorCode:0,ErrorInfo:"login success"};a(n)}Rn.setLongPollingOn(!0),u&&Rn.longPolling(a)},c)},c);else if(a){var l={ActionStatus:g.OK,ErrorCode:0,ErrorInfo:"login success(no login state)"};a(l)}},this.sendMsg=function(e,n,t){Ae(e,function(o){if(e.sess.type()==l.C2C){if(!On.addMsg(e)){var r="sendMsg: addMsg failed!",i=oe.getReturnError(r,-17);return re.error(r),void(t&&t(i))}On.updateTimeline()}n&&n(o)},function(e){t&&t(e)})}},Nn=new function(){this.fileMd5=null;var e=function(e,n,t){function o(){var n=a*s,t=n+s>=e.size?e.size:n+s,o=i.call(e,n,t);r.readAsArrayBuffer(o)}var r=null;try{r=new FileReader}catch(e){if(t)return void t(oe.getReturnError("当前浏览器不支持FileReader",-18))}var i=File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice;if(!i&&t)return void t(oe.getReturnError("当前浏览器不支持FileAPI",-19));var s=2097152,u=Math.ceil(e.size/s),a=0,c=new SparkMD5;r.onload=function(e){for(var t="",r=new Uint8Array(e.target.result),i=r.byteLength,s=0;s<i;s++)t+=String.fromCharCode(r[s]);c.appendBinary(t),a++,a<u?o():(this.fileMd5=c.end(),n&&n(this.fileMd5))},o()};this.uploadFile=function(n,t,o){var r={init:function(e,n,t){var o=this;o.file=e.file,o.onProgressCallBack=e.onProgressCallBack,e.abortButton&&(e.abortButton.onclick=o.abortHandler),o.total=o.file.size,o.loaded=0,o.step=1105920,o.sliceSize=0,o.sliceOffset=0,o.timestamp=ie(),o.seq=se(),o.random=ue(),o.fromAccount=V.identifier,o.toAccount=e.To_Account,o.fileMd5=e.fileMd5,o.businessType=e.businessType,o.fileType=e.fileType,o.cbOk=n,o.cbErr=t,o.reader=new FileReader,o.blobSlice=File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice,o.reader.onloadstart=o.onLoadStart,o.reader.onprogress=o.onProgress,o.reader.onabort=o.onAbort,o.reader.onerror=o.onerror,o.reader.onload=o.onLoad,o.reader.onloadend=o.onLoadEnd},upload:function(){r.readBlob(0)},onLoadStart:function(){},onProgress:function(e){var n=r;n.loaded+=e.loaded,n.onProgressCallBack&&n.onProgressCallBack(n.loaded,n.total)},onAbort:function(){},onError:function(){},onLoad:function(e){var n=r;if(e.target.readyState==FileReader.DONE){var t=e.target.result,o=t.indexOf(",");-1!=o&&(t=t.substr(o+1));var i={From_Account:n.fromAccount,To_Account:n.toAccount,Busi_Id:n.businessType,File_Type:n.fileType,File_Str_Md5:n.fileMd5,PkgFlag:M.BASE64_DATA,
File_Size:n.total,Slice_Offset:n.sliceOffset,Slice_Size:n.sliceSize,Slice_Data:t,Seq:n.seq,Timestamp:n.timestamp,Random:n.random},s=function(e){if(0==e.IsFinish)n.loaded=e.Next_Offset,n.loaded<n.total?n.readBlob(n.loaded):n.loaded=n.total;else if(n.cbOk){var t={ActionStatus:e.ActionStatus,ErrorCode:e.ErrorCode,ErrorInfo:e.ErrorInfo,File_UUID:e.File_UUID,File_Size:e.Next_Offset,URL_INFO:e.URL_INFO,Download_Flag:e.Download_Flag};n.fileType==y.FILE&&(t.URL_INFO=me(e.File_UUID,V.identifier,n.file.name)),n.cbOk(t)}K=0},u=function(e){K<20?(K++,setTimeout(function(){_n(i,s,u)},1e3)):n.cbErr(e)};_n(i,s,u)}},onLoadEnd:function(){},readBlob:function(e){var n,t=r,o=t.file,i=e+t.step;i>t.total?(i=t.total,t.sliceSize=i-e):t.sliceSize=t.step,t.sliceOffset=e,n=t.blobSlice.call(o,e,i),t.reader.readAsDataURL(n)},abortHandler:function(){var e=r;e.reader&&e.reader.abort()}};e(n.file,function(e){re.info("fileMd5: "+e),n.fileMd5=e,r.init(n,t,o),r.upload()},o)}};n.SESSION_TYPE=l,n.MSG_MAX_LENGTH=f,n.C2C_MSG_SUB_TYPE=C,n.GROUP_MSG_SUB_TYPE=S,n.MSG_ELEMENT_TYPE=d,n.GROUP_TIP_TYPE=F,n.IMAGE_TYPE=m,n.GROUP_SYSTEM_TYPE=R,n.FRIEND_NOTICE_TYPE=N,n.GROUP_TIP_MODIFY_GROUP_INFO_TYPE=O,n.BROWSER_INFO=s,n.Emotions=n.EmotionPicData=te,n.EmotionDataIndexs=n.EmotionPicDataIndex=ne,n.TLS_ERROR_CODE=P,n.CONNECTION_STATUS=U,n.UPLOAD_PIC_BUSSINESS_TYPE=b,n.RECENT_CONTACT_TYPE=p,n.UPLOAD_RES_TYPE=y,n.Tool=oe,n.Log=re,n.Msg=Fn,n.Session=Sn,n.MsgStore={sessMap:function(){return On.sessMap()},sessCount:function(){return On.sessCount()},sessByTypeId:function(e,n){return On.sessByTypeId(e,n)},delSessByTypeId:function(e,n){return On.delSessByTypeId(e,n)},resetCookieAndSyncFlag:function(){return On.resetCookieAndSyncFlag()}},n.Resources=ee,n.login=n.init=function(e,n,t,o,r){An.init(n.onConnNotify,o,r),_e(e,n,t,o,r)},n.logout=n.offline=function(e,n){return Ce("instance",e,n)},n.logoutAll=function(e,n){return Ce("all",e,n)},n.sendMsg=function(e,n,t){return Rn.sendMsg(e,n,t)},n.syncMsgs=function(e,n){return Rn.syncMsgs(e,n)},n.getC2CHistoryMsgs=function(e,n,t){return Rn.getC2CHistoryMsgs(e,n,t)},n.syncGroupMsgs=function(e,n,t){return Rn.syncGroupMsgs(e,n,t)},n.c2CMsgReaded=function(e,n,t){return On.c2CMsgReaded(e,n,t)},n.groupMsgReaded=function(e,n,t){return tn(e,n,t)},n.setAutoRead=function(e,n,t){return On.setAutoRead(e,n,t)},n.createGroup=function(e,n,t){return ve(e,n,t)},n.createGroupHigh=function(e,n,t){return Pe(e,n,t)},n.applyJoinGroup=function(e,n,t){return be(e,n,t)},n.handleApplyJoinGroupPendency=function(e,n,t){return De(e,n,t)},n.getPendencyGroup=function(e,n,t){return we(e,n,t)},n.getPendencyGroupRead=function(e,n,t){return ke(e,n,t)},n.handleInviteJoinGroupRequest=function(e,n,t){return qe(e,n,t)},n.deleteApplyJoinGroupPendency=function(e,n,t){return Re(e,n,t)},n.quitGroup=function(e,n,t){return xe(e,n,t)},n.searchGroupByName=function(e,n,t){return Ke(e,n,t)},n.getGroupPublicInfo=function(e,n,t){return He(e,n,t)},n.getGroupInfo=function(e,n,t){return ze(e,n,t)},n.modifyGroupBaseInfo=function(e,n,t){return Ue(e,n,t)},n.getGroupMemberInfo=function(e,n,t){return Je(e,n,t)},n.addGroupMember=function(e,n,t){return Ve(e,n,t)},n.modifyGroupMember=function(e,n,t){return Ye(e,n,t)},n.deleteGroupMember=function(e,n,t){return Xe(e,n,t)},n.destroyGroup=function(e,n,t){return We(e,n,t)},n.changeGroupOwner=function(e,n,t){return je(e,n,t)},n.getJoinedGroupListHigh=function(e,n,t){return Qe(e,n,t)},n.getRoleInGroup=function(e,n,t){return $e(e,n,t)},n.forbidSendMsg=function(e,n,t){return Ze(e,n,t)},n.sendCustomGroupNotify=function(e,n,t){return en(e,n,t)},n.applyJoinBigGroup=function(e,n,t){return Le(e,n,t)},n.quitBigGroup=function(e,n,t){return Be(e,n,t)},n.getProfilePortrait=function(e,n,t){return gn(e,n,t)},n.setProfilePortrait=function(e,n,t){return dn(e,n,t)},n.applyAddFriend=function(e,n,t){return rn(e,n,t)},n.getPendency=function(e,n,t){return an(e,n,t)},n.getPendencyReport=function(e,n,t){return cn(e,n,t)},n.deletePendency=function(e,n,t){return ln(e,n,t)},n.responseFriend=function(e,n,t){return pn(e,n,t)},n.getAllFriend=function(e,n,t){return fn(e,n,t)},n.deleteChat=function(e,n,t){return un(e,n,t)},n.deleteFriend=function(e,n,t){return sn(e,n,t)},n.addBlackList=function(e,n,t){return mn(e,n,t)},n.deleteBlackList=function(e,n,t){return In(e,n,t)},n.getBlackList=function(e,n,t){return Mn(e,n,t)},n.getRecentContactList=function(e,n,t){return En(e,n,t)},n.uploadFile=n.uploadPic=function(e,n,t){return Nn.uploadFile(e,n,t)},n.submitUploadFileForm=function(e,n,t){return Nn.submitUploadFileForm(e,n,t)},n.uploadFileByBase64=n.uploadPicByBase64=function(e,n,t){var o={To_Account:e.toAccount,Busi_Id:e.businessType,File_Type:e.File_Type,File_Str_Md5:e.fileMd5,PkgFlag:M.BASE64_DATA,File_Size:e.totalSize,Slice_Offset:0,Slice_Size:e.totalSize,Slice_Data:e.base64Str,Seq:se(),Timestamp:ie(),Random:ue()};return _n(o,n,t)},n.getLongPollingId=function(e,n,t){return Tn(0,n,t)},n.applyDownload=function(e,n,t){return Cn(e,n,t)},n.checkLogin=function(e,n){return pe(e,n)}}(n),n}();